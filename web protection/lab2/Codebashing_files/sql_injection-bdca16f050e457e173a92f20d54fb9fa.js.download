function source(){return 0===document.referrer.search("https?://(.*)google.([^/?]*)")?"Google":0===document.referrer.search("https?://(.*)bing.([^/?]*)")?"Bing":0===document.referrer.search("https?://(.*)yahoo.([^/?]*)")?"Yahoo":0===document.referrer.search("https?://(.*)facebook.([^/?]*)")?"Facebook":0===document.referrer.search("https?://(.*)twitter.([^/?]*)")?"Twitter":0===document.referrer.search("https?://(.*)reddit.([^/?]*)")?"Reddit":0===document.referrer.search("https?://(.*)linkedin.([^/?]*)")?"Linkedin":0===document.referrer.search("https?://(.*)codebashing.([^/?]*)")?"Linkedin":"Other"}var cbLayout,tutor,name="tour",value=localStorage.getItem(name),resize_status="status",resize_value=localStorage.getItem(resize_status),interval,calloutMgr,movie,movie2;$(window).load(function(){function e(){tutor=new jQueryCollapse($("#cb_tutor"),{open:function(){this.slideDown(150,function(){$("#sidepane").getNiceScroll().resize()})},close:function(){this.slideUp(150,function(){$("#sidepane").getNiceScroll().resize()})},accordion:!0})}function t(){n("north","100%"),$(".btnExpand").hide()}function o(){n("north","400"),$(".btnExpand").show()}function n(e,t){cbLayout.sizePane(e,t),cbLayout.open(e)}function r(e,t){var o=$.Deferred(),n=$('<iframe width="100%" height="100%" frameborder="0" scrolling="yes"></iframe>').attr({id:e,src:t});return n.load(o.resolve),n.appendTo("#vulnerable_application"),o.done(function(){}),o.promise()}function i(){$("#overlayfront, .help_title_main").fadeOut("fast")}function a(){$("#overlayfront, .help_title_main").fadeIn("fast")}function s(e,t){var o=$.Deferred();if($.browser.mozilla)var n=$('<iframe longdesc="https://codebashing.com:9001" width="100%" height="100%" frameborder="0" scrolling="no" onload="window.parent.frames[0].window.blah_one();"></iframe>').attr({id:e,src:t});else var n=$('<iframe longdesc="https://codebashing.com:9001" width="100%" height="100%" frameborder="0" scrolling="no" onload="parent.window.frames[0].window.blah_one();"></iframe>').attr({id:e,src:t});return n.load(o.resolve),n.appendTo("#logger_pane"),o.done(function(){}),o.promise()}function c(){$(".arrow_bounce").fadeIn(90),interval=setInterval(function(){jQuery(".arrow_bounce").effect("bounce",{times:1},300)},500)}mixpanel.register_once({Source:source()}),$("body").jpreLoader({loaderVPos:"50%"},function(){}),null!=value&&i(),$("#start").hide(),$(".arrow_bounce").hide(),$("#start").click(function(){$("#start").fadeOut("fast",function(){clearInterval(interval),$(".arrow_bounce").hide(),window.parent.frames[0].window.blah_three(),window.parent.frames[1].window.help_hide(),$("#cb_tutor").fadeIn(200),tutor.open(0),mixpanel.track("Start Clicked",{started:"1"})})}),$("[rel=tooltip]").tooltip({placement:"bottom"});var l='<div class="btnExpand"></div><div class="btnReset"></div>',d="auto";cbLayout=$("#container").layout({maskContents:!0,enableCursorHotkey:!1,center__contentSelector:"div.data",north__resizerDblClickToggle:!1,south__size:d,north__togglerLength_closed:35,north__togglerLength_open:35,north__togglerLength_closed:0,north__togglerLength_open:0,west__togglerLength_closed:35,west__togglerLength_open:35,west__togglerLength_closed:0,west__togglerLength_open:0,west__resizerDblClickToggle:!1,west__spacing_closed:0,west__spacing_open:0,useOffscreenClose:!1,north__togglerContent_closed:l,north__togglerContent_open:l,north__spacing_closed:0,north__spacing_open:0,onopen_end:function(){window.parent.frames[1].window._bringDown()},onresize_end:function(){$("#exercise_lock").css("height",cbLayout.state.north.size+"px")}}),cbLayout.sizePane("west","100%"),cbLayout.sizePane("north","100%");var u=cbLayout.togglers.north;u.unbind("click"),u.find(".btnExpand").click(t),u.find(".btnReset").click(o),cbLayout.hide("west","10"),$(".ui-layout-resizer-north").draggable("disable").css("cursor","default").attr("title",""),window.exercise_lock=function(){$("#exercise_lock").show("fast")},window.exercise_unlock=function(){$("#exercise_lock").hide("fast")},window.set_initial=function(){var e='String email = request.getParameter("email");\r\nString password = request.getParameter("password");\r\n\r\nString sql = "select * from users where email =\'" + email +"\' and password =\'" + password + "\')";\r\n\r\nConnection connection = pool.getConnection();\r\nStatement statement = connection.createStatement();\r\nResultSet result = statement.executeQuery(sql);\r\n\r\nif (result.next()) {\r\nloggedIn = true;\r\n    # Sucesfully logged in and redirect to user profile page\r\n} else {\r\n\r\n    # Auth failure - Redirect to Login Page \r\n}';movie2._editor.setValue(e)},window.open_code=function(){var e=$(".container").height()-320;cbLayout.sizePane("north",e),localStorage.setItem(resize_status,1),$(".ui-layout-resizer-north").draggable("enable").css("cursor","n-resize").attr("title",""),localStorage.setItem(resize_status,1),cbLayout.options.north.spacing_closed=6,cbLayout.options.north.spacing_open=6,cbLayout=$("#container").layout({north__spacing_closed:6,north__spacing_open:6}),cbLayout.resizeAll()},window.code_two=function(){window.exercise_lock(),cbLayout.show("west"),movie2._editor.refresh(),tutor.open(5),$("#five a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%")},window.code_three=function(){movie2=0,$("#code").next().remove(),$("#code").remove(),movie2=CodeMirror.movie("hidden_code"),$(".cm-s-mbo").css("height","100%"),parent.movie2._editor.refresh()},window.code_four=function(){movie2=0,$("#hidden_code").next().remove(),$("#hidden_code").remove(),movie2=CodeMirror.movie("vuln_code"),$(".cm-s-mbo").css("height","100%"),parent.movie2._editor.refresh()},window.code_five=function(){var e=$(".container").height()-400;cbLayout.sizePane("north",e),movie2=0,$("#vuln_code").next().remove(),$("#vuln_code").remove(),movie2=CodeMirror.movie("fix_code"),$(".cm-s-mbo").css("height","100%"),parent.movie2._editor.refresh()},window.exercise_complete=function(){function e(){parent.window.success_flash(),parent.window.success_bar("success")}e()},window.nextchapter=function(){window.location="/javas/xml_injection"},window.clearlog=function(){$(".line",window.parent.frames[1].document).remove()};var h={id:"hello-hopscotch",steps:[{title:"Start Here",content:"Each lesson starts here. Read the explanation, then follow the instructions underneath.",target:"sidepane",placement:"right",xOffset:-40,yOffset:20},{title:"Insecure Application",content:"This pane loads a vulnerable application or code. Type your response to the instructions here.",target:document.querySelector("#vulnerable_application"),placement:"left",xOffset:80,yOffset:20,onNext:function(){window.parent.frames[0].window.blah_three(),window.parent.frames[1].window.help_hide(),i(),c()}}],showPrevButton:!1,i18n:{doneBtn:"Im Ready"},onEnd:function(){$("#start").fadeIn(80),hopscotch.endTour({clearCookie:!1}),window.parent.frames[0].window.blah_three(),window.parent.frames[1].window.help_hide(),i(),localStorage.setItem(name,1),c()},onClose:function(){$("#start").fadeIn(80),window.parent.frames[0].window.blah_three(),window.parent.frames[1].window.help_hide(),i(),localStorage.setItem(name,1),c()}},p={id:"hello-hopscotch",steps:[{title:"Start Here",content:"Each lesson starts here. Read the explanation, then follow the instructions underneath.",target:"sidepane",placement:"right",xOffset:-40,yOffset:20},{title:"Insecure Application",content:"This pane loads a vulnerable application or code. Type your response to the instructions here.",target:document.querySelector("#vulnerable_application"),placement:"left",xOffset:80,yOffset:20}],showPrevButton:!1,i18n:{doneBtn:"Im Ready"},onEnd:function(){window.parent.frames[0].window.blah_three(),window.parent.frames[1].window.help_hide(),i()},onClose:function(){window.parent.frames[0].window.blah_three(),window.parent.frames[1].window.help_hide(),i()}};calloutMgr=hopscotch.getCalloutManager(),$("#info-tour").click(function(){window.parent.frames[0].window.blah_two(),window.parent.frames[1].window.help_show(),a(),hopscotch.startTour(p)}),$.when(e()).then(function(){$("#cb_tutor h3 a").click(function(){return!1}),localStorage.setItem(resize_status,0),$.when(r("iframeID2","https://trade-portal.codebashing.com/log_in")).then(function(){null==value&&window.parent.frames[0].window.blah_two(),$.when(s("iframeID","https://trade-portal.codebashing.com/logger")).then(function(){null==value&&window.parent.frames[1].window.help_show(),$("#vapp").hover(function(){window.parent.frames[0].window.blah_two()},function(){window.parent.frames[0].window.blah_three()}),$("#llog").hover(function(){window.parent.frames[1].window.help_show()},function(){window.parent.frames[1].window.help_hide()}),null==value&&hopscotch.startTour(h),$.getScript("//platform.twitter.com/widgets.js",function(){$("#tweet").html('<a href="https://twitter.com/share" class="twitter-share-button"{count} data-url="http://www.codebashing.com/try-it" data-text="Awesome SQL Injection tutorial #appsec #security #programming" data-via="codebashing" onclick="ga(\'send\', \'event\', \'Social Media\', \'Twitter\', \'Share\');">Share</a>'),twttr.widgets.load()}),document.getElementById("xtasy").onkeypress=function(e){var t=window.parent.frames[0].location,o=e||window.event,n=o.which||o.keyCode;if("13"==n){console.log("pressed");var r=$("#testparent").val().indexOf("https://trade-portal.codebashing.com");return 0==r?(window.parent.frames[0].location=$("#testparent").val(),t=$("#testparent").val()):(window.parent.frames[0].location=t,window.parent.frames[0].location.reload(),o.preventDefault()),!1}},movie2=CodeMirror.movie("code"),$(document).on("click",function(e){var t=e.target.getAttribute("data-label");"stop"==t?(movie2.stop(),window.hideTooltip()):"play"==t?movie2.play():t&&movie2["goto"](t)}),$("#highlight-vulnerable").click(function(){movie2.play()}),$("#start").fadeIn(80),window.spinnerStop22(),$(".container").show()})})});var w=(setTimeout(function(){$("#sidepane").niceScroll({autohidemode:!1,cursorborderradius:"0px",background:{color:"#E5E9E7"},cursorwidth:"7px",cursorcolor:"#999999",cursorborderradius:"3px",cursorborder:{border:"none"}})},600),{lines:13,length:4,width:2,radius:4,corners:1,rotate:0,direction:1,color:"#000",speed:.9,trail:44,shadow:!1,hwaccel:!1,className:"spinner",zIndex:99999999}),f=document.getElementById("vulnerable_application"),m=new Spinner(w).spin(f);$(f).data("spinner",m);var g={lines:13,length:9,width:4,radius:8,corners:1,rotate:0,direction:1,color:"#000",speed:.9,trail:44,shadow:!1,hwaccel:!1,className:"start",zIndex:99999999},_=document.getElementById("sidepane"),b=new Spinner(g).spin(_);$(_).data("start",b),window.spinnerStop22=function(){$("#sidepane").data("start").stop()},window.spinnerStop=function(){$("#vulnerable_application").data("spinner").stop()},window.spinnerStart=function(){var e=new Spinner(w).spin(f);$(f).data("spinner",e)},$.pnotify.defaults.history=!1;var v={dir1:"up",dir2:"right",spacing1:0,firstpos2:0};window.success_bar=function(e){var t={addclass:"stack-bar-bottom",cornerclass:"",width:"100%",height:"100px",stack:v,icon:!0,hide:!1,sticker:!1,insert_brs:!1};switch(e){case"success":t.text=$("#form_notice").html(),t.type="success",t.closer=!0}$.pnotify(t)},window.success_flash=function(){iosOverlay({text:"Success!",duration:2e3,icon:"/assets/img/check.png"})}}),$(document).ready(function(){$(window).resize(function(){if(0==localStorage.getItem(resize_status))window.cbLayout,cbLayout.resizeAll(),cbLayout.sizePane("north","100%"),cbLayout.sizePane("west","100%");else{cbLayout.resizeAll();var e=$(".container").height()-320;cbLayout.sizePane("north",e),cbLayout.sizePane("west","100%")}})}),$(document).ready(function(){$("#blue-one").click(function(){window.clearlog(),tutor.open(1),$("#one a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%"),window.open_code()}),$("#blue-two").click(function(){tutor.open(2),$("#two a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%"),window.exercise_unlock()}),$("#blue-three").click(function(){tutor.open(3),$("#three a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%")}),$("#blue-four").click(function(){tutor.open(4),$("#four a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%")}),$("#blue-five").click(function(){tutor.open(5),$("#five a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%")}),$("#highlight-vulnerable").click(function(){$(this).fadeOut("fast",function(){$(this).remove(),$(".showcode").append('<a style="color: #f05023; text-decoration: none; display: none; cursor: pointer;" class="blue-button" id="blue-six">Next</a>'),movie2.play()})}),$(document).on("click","#blue-six",function(){$("#six a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%"),$(this).fadeOut("fast",function(){mixpanel.track("Progress",{progress:"50"}),tutor.open(6),window.code_three()})}),$("#highlight-vulnerable-2").click(function(){$(this).fadeOut("fast",function(){$(this).remove(),$(".showcode2").append('<a style="color: #f05023; text-decoration: none; display: none; cursor: pointer;" class="blue-button" id="blue-seven">Next</a>'),movie2.play()})}),$(document).on("click","#blue-seven",function(){$("#seven a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%"),$(this).fadeOut("fast",function(){tutor.open(7),window.exercise_unlock()})}),$("#highlight-vulnerable-3").click(function(){window.code_four(),$(this).fadeOut("fast",function(){$(this).remove(),$(".showcode3").append('<a style="color: #f05023; text-decoration: none; display: none; cursor: pointer;" class="blue-button" id="blue-ten">Next</a>'),movie2.play(),window.exercise_lock()})}),$(document).on("click","#blue-ten",function(){$("#ten a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%"),$(this).fadeOut("fast",function(){tutor.open(10),window.code_five()})}),$("#highlight-vulnerable-4").click(function(){$(this).fadeOut("fast",function(){$(this).remove(),$(".showcode4").append('<a style="color: #f05023; text-decoration: none; display: none; cursor: pointer;" class="blue-button" id="blue-eleven">Next</a>'),movie2.play()})}),$(document).on("click","#blue-eleven",function(){$("#eleven a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%"),$(this).fadeOut("fast",function(){tutor.open(11)})}),$("#blue-twelve").click(function(){$("#twelve a").css("background","url(https://codebashing.com/assets/images/checkmark.png) no-repeat 95% 50%"),$(this).fadeOut("fast",function(){mixpanel.track("Progress",{progress:"100"}),exercise_complete()})})});